---
layout: post
title: Automated install of PowerShell on Windows XP
date: '2013-11-08T08:14:00.000-08:00'
author: Gert Lombard
tags:
- batch
- PowerShell
- WindowsXP
- automation
modified_time: '2013-11-09T11:04:25.240-08:00'
blogger_id: tag:blogger.com,1999:blog-1583243090910089198.post-8377914514239668690
blogger_orig_url: http://www.lombard.me/2013/11/automated-install-of-powershell-on-xp.html
---

<b>The problem:</b> I want a batch script to perform an unattended/silent install of PowerShell on Windows XP.<br /><div><br /></div><div>We need to download the PowerShell installer from Microsoft, but it needs to be downloaded from an HTTP server. I'm not aware of an easy way to download files from the command-line or script in Windows XP, other than the FTP command. But what we can do easily, is to download cURL via FTP first.</div><div><br /></div><div>So we need to download 4 things from the batch script:</div><div><ol><li>We need to get 7-Zip to extract cURL.</li><li>We need to get cURL (or wget) to download PowerShell.</li><li>Download and install .NET Framework 2 since it's required by PowerShell.</li><li>Finally we download PowerShell itself from Microsoft via HTTP.</li></ol><div><b>Step 1:</b> download 7-Zip archiver's command-line version (7za.exe) from an FTP server. You need to search for any FTP server that hosts 7za.exe.</div><div><br /></div><div>This FTP script would work to get 7za:</div><pre><code>open ftp.cadwork.ch<br />user<br />anonymous<br /><br />cd /DVD_V17/CADWORK.DIR/COM/<br />bin<br />get 7za.exe<br /></code></pre><div><b>Step 2:</b> download&nbsp;curl from one of the official FTP mirrors if you can. I didn't have any luck with the official mirrors so I just searched around until I found an older version.<br /><br />This FTP script would work to get curl 7.19.3:&nbsp;</div><pre><code>open ftp.gr.freebsd.org<br />user<br />anonymous<br /><br />cd /pub/net/ftp/curl/<br />bin<br />get curl-7.19.3-win32-nossl.zip<br /></code></pre><div>Now we can use 7za.exe to extract the curl zip file.<br /><br /><b>Step 3:</b> download <a href="http://www.microsoft.com/en-ie/download/details.aspx?id=1639">.NET Framework 2.0</a> and install it silently:<br /><pre><code>curl -O http://download.microsoft.com/download/c/6/e/c6e88215-0178-4c6c-b5f3-158ff77b1f38/NetFx20SP2_x86.exe<br /></code></pre><pre><code>start /wait "Installing .NET" NetFx20SP2_x86.exe /qb</code></pre></div><div><b>Step 4:</b> download <a href="http://www.microsoft.com/en-us/download/details.aspx?id=16818">PowerShell for Winfows XP</a> and install it silently:<br /><pre><code>curl -O&nbsp;http://download.microsoft.com/download/E/C/E/ECE99583-2003-455D-B681-68DB610B44A4/WindowsXP-KB968930-x86-ENG.exe<br />start /wait "Installing PowerShell" WindowsXP-KB968930-x86-ENG.exe /passive /log:powershell-install.log<br /></code></pre>The final batch file to put it all together is <a href="https://github.com/glombard/Scripts/blob/master/PowerShell-Installers/Get-PowerShell-WinXP.bat">here</a>.<br /><br />If you're curious why I'd be using Windows XP: I sometimes need to test old software. In this case, I want to install Visual C++ 6 to see if some old C++&nbsp;code compiles without warnings before I start the process of converting it to a newer Visual Studio.</div><div><br /></div><div>Note: I used <a href="http://www.filewatcher.com/_/?q=7za.exe&amp;p=1">FileWatcher.com</a> to search for FTP servers that host the 7-Zip command-line tool (7za.exe) and cURL.<br /><br /></div></div>